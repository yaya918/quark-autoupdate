夸克失效任务增量更新脚本

项目简介

夸克失效任务增量更新脚本是基于 [quark-auto-save](https://github.com/cp0204/quark-auto-save) 项目的增强插件，专门用于自动检测和更新已失效的夸克网盘分享任务。当原分享链接失效时，本脚本能够智能搜索新的有效资源，并只转存已转存资源之后的新文件，实现无缝续播。

核心功能

🔄 智能失效检测
- 自动识别配置文件中标记为失效的任务
- 实时验证分享链接有效性
- 记录失效原因和时间戳

🔍 资源智能搜索
- 基于任务名称自动搜索替代资源
- 多源候选资源评估和筛选
- 智能匹配任务名称，避免误匹配

📊 剧集连续性分析
- 分析已转存剧集信息
- 确定续播起始点
- 避免重复转存已存在的剧集

🎯 最佳资源选择
- 多维度评分系统：
  - 剧集连续性（50%）
  - 集数范围完整性（30%）
  - 文件组织结构（20%）
- 自动选择最优替代资源

📁 智能文件夹处理
- 识别文件夹结构的资源
- 生成文件夹级分享链接
- 优化转存效率和成功率

安装方法

独立运行模式

```bash
# 直接运行脚本（将本脚本与quark-auto-save配置文件放在同一目录下）
python quark_failed_task_update.py

# 指定配置文件路径（指定quark-auto-save配置文件）
python quark_failed_task_update.py /path/to/your/quark_config.json
```

配置说明
self.api_token = "xxxxxxxxxxxx"  #quark-auto-save的token值
self.base_url = "http://192.168.2.99:15005" #quark-auto-save的url地址



使用流程

1. 自动检测
运行脚本检测所有标记为失效的任务。

#2. 资源搜索
对于每个失效任务：
- 通过API搜索新的候选资源
- 验证资源有效性
- 分析资源结构

3. 智能匹配
- 对比候选资源与原始任务名称
- 分析剧集连续性
- 评估资源质量

4. 增量更新
- 确定续播起始点
- 更新分享链接
- 移除失效标记
- 保存配置更新

使用示例

场景：电视剧追更中断
假设你正在追更《绝世唐门》，原分享链接失效：

**原任务配置：**
```json
{
  "taskname": "绝世唐门",
  "shareurl": "https://pan.quark.cn/s/xxx",
  "savepath": "/TV/绝世唐门",
  "shareurl_ban": "链接失效"
}
```

**插件处理过程：**
1. 检测到任务标记为失效
2. 搜索新的《绝世唐门》资源
3. 分析已转存剧集（比如已存1-40集）
4. 找到包含41-50集的新资源
5. 更新分享链接并移除失效标记
6. 设置从第41集开始转存



注意事项

⚠️ 使用建议
1. 合理频率：避免过高频率运行，建议每天1-2次
2. 资源质量：插件会优先选择剧集连续、结构清晰的资源
3. 网络环境：确保API服务可正常访问
4. 配置备份：定期备份配置文件，防止意外丢失


更新日志

v1.0.0
- 初始版本发布
- 支持失效任务检测和自动更新
- 集成剧集连续性分析
- 添加智能资源评分系统

技术支持

- 📖 详细文档：参考 quark-auto-save 的 Wiki
- 🐛 问题反馈：在 GitHub Issues 中提交
- 💡 功能建议：欢迎提出改进建议

## 免责声明

本脚本仅供学习交流使用，请勿用于商业用途。使用者应遵守夸克网盘的相关服务条款，合理使用资源分享功能。开发者不对因使用本脚本而产生的任何问题负责。
